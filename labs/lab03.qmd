---
title: "Lab 3 – Κανονική Κατανομή, Κεντρικό Οριακό Θεώρημα & Διωνυμική"
format:
  html:
    toc: true
    code-fold: true
    code-tools: true
execute:
  warning: false
  message: false
---

## Στόχοι

Με το τέλος του εργαστηρίου θα μπορείς να:

- χρησιμοποιείς την κανονική κατανομή στην R
- υπολογίζεις πιθανότητες με `pnorm()`
- μετατρέπεις τιμές σε z-score
- κατανοείς το Κεντρικό Οριακό Θεώρημα
- χρησιμοποιείς τη διωνυμική κατανομή (`rbinom()`, `pbinom()`)
- συνδέεις επιπολασμό με πιθανότητα δείγματος

---

## Προετοιμασία

```{r setup}
pkgs <- c("ggplot2", "dplyr")
to_install <- setdiff(pkgs, rownames(installed.packages()))
if (length(to_install) > 0) {
  install.packages(to_install, repos = "https://cloud.r-project.org")
}
invisible(lapply(pkgs, library, character.only = TRUE))
```

---

## 1. Η Κανονική Κατανομή

Η κανονική κατανομή:

- είναι συμμετρική
- έχει σχήμα καμπάνας
- περιγράφεται από:
  - μέσο (μ)
  - τυπική απόκλιση (σ)

---

### Προσομοίωση

```{r}
set.seed(123)
x <- rnorm(10000, mean = 10, sd = 2)
hist(x, breaks = 40, col="lightblue",
     main="Κανονική κατανομή",
     xlab="Τιμή")
```

---

Ο κανόνας 68–95–99.7 αναφέρει ότι:

- περίπου 68% των τιμών βρίσκονται στο διάστημα $[-1, 1]$
- περίπου 95% στο $[-2, 2]$
- περίπου 99.7% στο $[-3, 3]$


Υπολογίζουμε:

Για την τυπική κανονική $Z \sim N(0,1)$:

```{r}
pnorm(1) - pnorm(-1)
pnorm(2) - pnorm(-2)
pnorm(3) - pnorm(-3)
```

---


## 2. Z-score (Τυποποίηση)

Αν $X \sim N(\mu, \sigma^2)$, τότε:

$Z = \frac{X - \mu}{\sigma} \sim N(0,1)$

όπου $\mu$ ο μέσος και $\sigma$ η τυπική απόκλιση.

---

### Παράδειγμα

```{r}
z <- (12 - 10)/2
z
pnorm(z)
```

---


## 3. Παράδειγμα Κύησης

Η διάρκεια κύησης:
- μ = 266 ημέρες
- σ = 16 ημέρες

Πιθανότητα να διαρκέσει μεταξύ 240 και 270 ημερών:

```{r}
pnorm(270, 266, 16) - pnorm(240, 266, 16)
```

---

## 4. Κεντρικό Οριακό Θεώρημα (Διαίσθηση)

Ακόμα κι αν ο πληθυσμός δεν είναι κανονικός, η κατανομή του δειγματικού μέσου τείνει σε κανονική μορφή καθώς το μέγεθος δείγματος $n$ αυξάνει.

---

### Μη κανονικός πληθυσμός & Μέσοι όροι δειγμάτων

```{r}
set.seed(11232)
par(mfrow=c(1,2))
a <- rbeta(10000, 2, 5)
hist(a, main="Μη κανονικός πληθυσμός", col="lightgray")

means <- replicate(2000, mean(sample(a, 20)))
hist(means, main="Μέσοι όροι (n=20)", col="lightgreen")

par(mfrow=c(1,1))

```


👉 Παρατήρηση: Η κατανομή γίνεται κανονική. Η διασπορά των μέσων όρων είναι μικρότερη από τη διασπορά του αρχικού πληθυσμού. Συγκεκριμένα, η τυπική απόκλιση του δειγματικού μέσου είναι $\sigma / \sqrt{n}$.

---

## 5. Η Διωνυμική Κατανομή

Η διωνυμική περιγράφει:

- αριθμό επιτυχιών
- σε n ανεξάρτητες δοκιμές
- με πιθανότητα p

---


### Προσομοίωση

```{r}
hist(rbinom(10000, 20, 0.3),
     main="Διωνυμική κατανομή (n=20, p=0.3)",
     col="salmon")
```

---

### Υπολογισμός Πιθανοτήτων

Πιθανότητα έως 2 επιτυχίες σε 20 με p=0.1:

```{r}
pbinom(2, 20, 0.1)
```

---


## 6. Παράδειγμα Επιπολασμού

Σε πληθυσμό:

- p = 0.08  
- n = 150  

Πιθανότητα να έχουμε ≥15 επιτυχίες:

```{r}
1 - pbinom(14, 150, 0.08)
```

---


## 7. Όταν το n μεγαλώνει…

```{r, fig.width = 10, fig.height = 3}
set.seed(123)
par(mfrow=c(1,3))

hist(rbinom(10000, 10, 0.3),
     main="n=10", col="lightblue")

hist(rbinom(10000, 30, 0.3),
     main="n=30", col="lightgreen")

hist(rbinom(10000, 100, 0.3),
     main="n=100", col="orange")

par(mfrow = c(1,1)) 

```

👉 Όσο μεγαλώνει το n, η διωνυμική μοιάζει με κανονική.

---

## 📝 Ασκήσεις

### Κανονική Κατανομή

Η θερμοκρασία σώματος έχει:

- μ = 36.6°C
- σ = 0.4°C

- Ποια η πιθανότητα κάποιος να έχει θερμοκρασία > 37.5°C;

---

### Διωνυμική κατανομή

Αν 20% των φοιτητών διαβάζει πριν το μάθημα, σε 15 φοιτητές:

- Ποια η πιθανότητα 3 ή λιγότεροι να έχουν διαβάσει;

---

### Πειραματιστείτε

Τι συμβαίνει:

- Αν αυξήσετε το p στη διωνυμική;
- Αν αυξήσετε το n;
- Αν μειώσετε το sd στην κανονική;

Δοκιμάστε στην R.

---

🔑 Κεντρικό Μήνυμα
- Η κανονική κατανομή περιγράφει συνεχή φαινόμενα.
- Η διωνυμική περιγράφει αριθμό επιτυχιών.
- Το μεγάλο δείγμα φέρνει κανονικότητα.
- Η πιθανότητα είναι εργαλείο περιγραφής αβεβαιότητας.

---
